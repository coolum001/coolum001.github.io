<!DOCTYPE html>
<html lang="english">
<head>

    <meta charset="utf-8">
    <title>net-analysis.com Data Analysis Blog <small>scipy</small></title>
    <meta name="description" content="">
    <meta name="author" content="Don Cameron">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="../theme/html5.js"></script>
    <![endif]-->


    <!-- Le styles -->
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap.no-icons.min.css" rel="stylesheet">
    <link href="../theme/local.css" rel="stylesheet">
    <link href="../theme/pygments.css" rel="stylesheet">
    <link href="../theme/font-awesome.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Gudea:400,400italic|Alegreya+SC' rel='stylesheet' type='text/css'>

</head>

<body>
<header class="blog-header">
  <div class="container">
    <div class="row-fluid">
      <div class="span9">
	<a href=".." class="brand">net-analysis.com Data Analysis Blog</a>
      </div>

      <div class="span3" id="blog-nav">
	<ul class="nav nav-pills pull-right">
	    <li >
	      <a href="../category/anova.html ">ANOVA</a>
	    <li >
	      <a href="../category/arduino.html ">Arduino</a>
	    <li >
	      <a href="../category/basemap.html ">Basemap</a>
	    <li >
	      <a href="../category/cartopy.html ">Cartopy</a>
	    <li >
	      <a href="../category/fastai.html ">fastai</a>
	    <li >
	      <a href="../category/folium.html ">Folium</a>
	    <li >
	      <a href="../category/geopandas.html ">GeoPandas</a>
	    <li >
	      <a href="../category/geoplot.html ">Geoplot</a>
	    <li >
	      <a href="../category/introduction.html ">Introduction</a>
	    <li >
	      <a href="../category/landsat.html ">LANDSAT</a>
	    <li >
	      <a href="../category/numpy.html ">numpy</a>
	    <li >
	      <a href="../category/osmnx.html ">OSMNX</a>
	    <li >
	      <a href="../category/python.html ">Python</a>
	    <li  class="active" >
	      <a href="../category/scipy.html ">scipy</a>
	    <li >
	      <a href="../category/sympy.html ">sympy</a>
	    <li >
	      <a href="../category/testing.html ">Testing</a>
	    <li >
	      <a href="../category/visualizations.html ">Visualizations</a>
	</ul>
      </div>
    </div> <!-- End of fluid row-->
  </div>   <!-- End of Container-->
</header>
    
<div class="container">
    <div class="content">
    <div class="row-fluid">

        <div class="span10">
        

        

    <div class='row-fluid''>
        <div class="article-title span9">
            <a href="../stats19115.html"><h1>Stanford STATS191 in Python, Lecture 15 : Poisson Regression</h1></a>
        </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<p>Mon 25 May 2020 </p>

<p style="text-align: left;">
Filed under <a href="../category/scipy.html">scipy</a>
</p>
<p style="text-align: left;">
 
    Tags <a href="../tag/statistics-scipy-statsmodels.html">statistics scipy statsmodels</a> </p>
<p>
</p>
      </div>
      <div class="article-content span8">
	<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Stanford-Stats-191">Stanford Stats 191<a class="anchor-link" href="#Stanford-Stats-191">&#182;</a></h1><h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">&#182;</a></h2><p>This is a re-creation of the Stanford Stats 191 course, using Python eco-system tools, instead of R. This is lecture "Poisson: " ( see <a href="https://web.stanford.edu/class/stats191/notebooks/Poisson.html">https://web.stanford.edu/class/stats191/notebooks/Poisson.html</a> )</p>
<p>In this notebook, we look at modelling count data.  The model is that of a Poisson process, where events occur in a fixed interval of time or space if these events occur with a constant mean rate and independently of the time since the last event.  The probability we get <code>x</code> events in a unit time is shown below</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$P(X=x)=\dfrac{\lambda^x e^{-\lambda}}{x!}\qquad x=0,1,2,\ldots$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Initial-Notebook-Setup">Initial Notebook Setup<a class="anchor-link" href="#Initial-Notebook-Setup">&#182;</a></h2><p><code>watermark</code> documents the Python and package environment, <code>black</code> is my chosen Python formatter</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> lab_black
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sn</span>

<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="k">import</span> <span class="n">logit</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="k">import</span> <span class="n">probit</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="k">import</span> <span class="n">glm</span>


<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>

<span class="kn">import</span> <span class="nn">os</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Simple-Contingency-Table">Simple Contingency Table<a class="anchor-link" href="#Simple-Contingency-Table">&#182;</a></h2><p>We wish to test if Males and Females answer a question differently</p>
<p>First, create a <code>pandas</code> dataframe from the survey data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">435</span><span class="p">,</span> <span class="mi">375</span><span class="p">],</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">147</span><span class="p">,</span> <span class="mi">134</span><span class="p">]}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[33]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Y</th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>435</td>
      <td>147</td>
    </tr>
    <tr>
      <th>1</th>
      <td>375</td>
      <td>134</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Give names to vertical and horizontal indexes</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Response&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[35]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Response</th>
      <th>Y</th>
      <th>N</th>
    </tr>
    <tr>
      <th>Gender</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>M</th>
      <td>435</td>
      <td>147</td>
    </tr>
    <tr>
      <th>F</th>
      <td>375</td>
      <td>134</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get the data as a <code>numpy</code> array, and then process with the <code>Table</code> object</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab0</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[43]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>array([[435, 375],
       [147, 134]], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">tab0</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tab1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>A 2x2 contingency table with counts:
[[435. 147.]
 [375. 134.]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab1</span><span class="o">.</span><span class="n">table_orig</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[56]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>array([[435, 147],
       [375, 134]], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab1</span><span class="o">.</span><span class="n">fittedvalues</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[58]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>array([[432.09899175, 149.90100825],
       [377.90100825, 131.09899175]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Show the contributions to the Chi-squared statistic</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab1</span><span class="o">.</span><span class="n">chi2_contribs</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[59]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.01947667, 0.05614271],
       [0.02226998, 0.06419461]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Assess the indepedence between rows and columns (both as nominal and ordinal variables)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tab1</span><span class="o">.</span><span class="n">test_nominal_association</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>df          1
pvalue      0.6872450563829144
statistic   0.16208397298431804
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tab1</span><span class="o">.</span><span class="n">test_ordinal_association</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>null_mean   131.09899175068745
null_sd     7.209050259693882
pvalue      0.6873808486214543
statistic   134.0
zscore      0.4024119883769182
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get the Chi-squared value; we see that it is quiet likely that we would get the observed value by chance</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab1_chi2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">tab1</span><span class="o">.</span><span class="n">chi2_contribs</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">tab1_chi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[95]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>0.6872450563829144</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab1_chi2</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[71]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>0.16208397298431804</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I found the Chi-squared curve for degree-of-freedom = 1 to be quiet counter-intuitive.  It was only when I plotted out the PDF and CDF, that I realized that a lot of the probability mass is concentrated near zero</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[94]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Chi2 PDF&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;g:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Chi2 CDF&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">tab1_chi2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>statsmodels</code> also has a specific Object for 2 by 2 tables, as below</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">Table2x2</span><span class="p">(</span><span class="n">tab0</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tab2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[54]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<tr>
         <td></td>        <th>Estimate</th>  <th>SE</th>     <th>LCB</th>   <th>UCB</th>  <th>p-value</th>
</tr>
<tr>
  <th>Odds ratio</th>        <td>1.057</td>      <td></td>  <td>0.806</td> <td>1.388</td>   <td>0.687</td>
</tr>
<tr>
  <th>Log odds ratio</th>    <td>0.056</td> <td>0.139</td> <td>-0.216</td> <td>0.328</td>   <td>0.687</td>
</tr>
<tr>
  <th>Risk ratio</th>        <td>1.015</td>      <td></td>  <td>0.946</td> <td>1.088</td>   <td>0.688</td>
</tr>
<tr>
  <th>Log risk ratio</th>    <td>0.014</td> <td>0.036</td> <td>-0.056</td> <td>0.085</td>   <td>0.688</td>
</tr>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="scipy">scipy<a class="anchor-link" href="#scipy">&#182;</a></h2><p><code>scipy</code> also has Chi-squared analysis methods, that are a little more advanced than <code>statsmodels</code>, in that they offer a variety of correction methods to estimate Chi-squared</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With Yates correction</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">chi2</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span>
    <span class="n">tab0</span><span class="o">.</span><span class="n">T</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39; chi2 = </span><span class="si">{chi2}</span><span class="s1">, P value = </span><span class="si">{p_value}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre> chi2 = 0.1110272160868229, P value = 0.7389776820172238
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Without Yates correction</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[107]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">chi2</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span>
    <span class="n">tab0</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">correction</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39; chi2 = </span><span class="si">{chi2}</span><span class="s1">, P value = </span><span class="si">{p_value}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre> chi2 = 0.1620839729843177, P value = 0.6872450563829149
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[103]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">odds_ratio</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">fisher_exact</span><span class="p">(</span><span class="n">tab0</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_value</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7286890678300681
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Poisson-Regression">Poisson Regression<a class="anchor-link" href="#Poisson-Regression">&#182;</a></h2><p>We can also treat this as a case of regression, where we assume the rate of <code>Y</code> or <code>N</code> answers might depend upon gender</p>
<p>We build a dataframe with the data, one row per observation</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[108]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_dict2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">435</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">375</span><span class="p">,</span> <span class="mi">134</span><span class="p">],</span>
    <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[110]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict2</span><span class="p">)</span>
<span class="n">df2</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[110]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Y</th>
      <th>S</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>435</td>
      <td>M</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>147</td>
      <td>M</td>
      <td>N</td>
    </tr>
    <tr>
      <th>2</th>
      <td>375</td>
      <td>F</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>3</th>
      <td>134</td>
      <td>F</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now fit a Poisson model.  We get the same Chi-squared value as before</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[111]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">glm</span><span class="p">(</span>
    <span class="s1">&#39;Y ~ S + B&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">()</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[112]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[112]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<caption>Generalized Linear Model Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>Y</td>        <th>  No. Observations:  </th>  <td>     4</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>GLM</td>       <th>  Df Residuals:      </th>  <td>     1</td>  
</tr>
<tr>
  <th>Model Family:</th>        <td>Poisson</td>     <th>  Df Model:          </th>  <td>     2</td>  
</tr>
<tr>
  <th>Link Function:</th>         <td>log</td>       <th>  Scale:             </th> <td>  1.0000</td> 
</tr>
<tr>
  <th>Method:</th>               <td>IRLS</td>       <th>  Log-Likelihood:    </th> <td> -14.704</td> 
</tr>
<tr>
  <th>Date:</th>           <td>Fri, 22 May 2020</td> <th>  Deviance:          </th> <td> 0.16200</td> 
</tr>
<tr>
  <th>Time:</th>               <td>20:33:01</td>     <th>  Pearson chi2:      </th>  <td> 0.162</td>  
</tr>
<tr>
  <th>No. Iterations:</th>         <td>4</td>        <th>  Covariance Type:   </th> <td>nonrobust</td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    4.8760</td> <td>    0.068</td> <td>   71.839</td> <td> 0.000</td> <td>    4.743</td> <td>    5.009</td>
</tr>
<tr>
  <th>S[T.M]</th>    <td>    0.1340</td> <td>    0.061</td> <td>    2.208</td> <td> 0.027</td> <td>    0.015</td> <td>    0.253</td>
</tr>
<tr>
  <th>B[T.Y]</th>    <td>    1.0587</td> <td>    0.069</td> <td>   15.291</td> <td> 0.000</td> <td>    0.923</td> <td>    1.194</td>
</tr>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[115]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">fittedvalues</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[115]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>0    432.098992
1    149.901008
2    377.901008
3    131.098992
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Lumber-Dataset">Lumber Dataset<a class="anchor-link" href="#Lumber-Dataset">&#182;</a></h2><p>Finally, we look at a dataset, relating to customers travelling to a lumber store from different regions</p>
<table>
<thead><tr>
<th>Column</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>Customers</td>
<td>number of customers visting store from region</td>
</tr>
<tr>
<td>Housing</td>
<td>number of housing units in region</td>
</tr>
<tr>
<td>Income</td>
<td>average household income</td>
</tr>
<tr>
<td>Age</td>
<td>average housing unit age in region</td>
</tr>
<tr>
<td>Competitor</td>
<td>distance to nearest competitor</td>
</tr>
<tr>
<td>Store</td>
<td>distance to store in miles.</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Read-and-Explore-Dataset">Read and Explore Dataset<a class="anchor-link" href="#Read-and-Explore-Dataset">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[118]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lumber</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span>
    <span class="s1">&#39;../data/lumber.txt&#39;</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">lumber</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Customers&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Housing&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Income&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Competitor&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Store&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[119]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lumber</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[119]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customers</th>
      <th>Housing</th>
      <th>Income</th>
      <th>Age</th>
      <th>Competitor</th>
      <th>Store</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9</td>
      <td>606</td>
      <td>41393</td>
      <td>3</td>
      <td>3.04</td>
      <td>6.32</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>641</td>
      <td>23635</td>
      <td>18</td>
      <td>1.95</td>
      <td>8.89</td>
    </tr>
    <tr>
      <th>2</th>
      <td>28</td>
      <td>505</td>
      <td>55475</td>
      <td>27</td>
      <td>6.54</td>
      <td>2.05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11</td>
      <td>866</td>
      <td>64646</td>
      <td>31</td>
      <td>1.67</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>599</td>
      <td>31972</td>
      <td>7</td>
      <td>0.72</td>
      <td>8.11</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Perform a Poisson Regression, using the Generalized Linear Model formula interface</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[120]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res2</span> <span class="o">=</span> <span class="n">glm</span><span class="p">(</span>
    <span class="s1">&#39;Customers ~ Housing + Income + Age + Competitor + Store&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">lumber</span><span class="p">,</span>
    <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(),</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">res2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[120]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<caption>Generalized Linear Model Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>      <td>Customers</td>    <th>  No. Observations:  </th>  <td>   110</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>GLM</td>       <th>  Df Residuals:      </th>  <td>   104</td>  
</tr>
<tr>
  <th>Model Family:</th>        <td>Poisson</td>     <th>  Df Model:          </th>  <td>     5</td>  
</tr>
<tr>
  <th>Link Function:</th>         <td>log</td>       <th>  Scale:             </th> <td>  1.0000</td> 
</tr>
<tr>
  <th>Method:</th>               <td>IRLS</td>       <th>  Log-Likelihood:    </th> <td> -279.51</td> 
</tr>
<tr>
  <th>Date:</th>           <td>Fri, 22 May 2020</td> <th>  Deviance:          </th> <td>  114.99</td> 
</tr>
<tr>
  <th>Time:</th>               <td>20:45:16</td>     <th>  Pearson chi2:      </th>  <td>  102.</td>  
</tr>
<tr>
  <th>No. Iterations:</th>         <td>4</td>        <th>  Covariance Type:   </th> <td>nonrobust</td>
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>  <td>    2.9424</td> <td>    0.207</td> <td>   14.198</td> <td> 0.000</td> <td>    2.536</td> <td>    3.349</td>
</tr>
<tr>
  <th>Housing</th>    <td>    0.0006</td> <td>    0.000</td> <td>    4.262</td> <td> 0.000</td> <td>    0.000</td> <td>    0.001</td>
</tr>
<tr>
  <th>Income</th>     <td>-1.169e-05</td> <td> 2.11e-06</td> <td>   -5.534</td> <td> 0.000</td> <td>-1.58e-05</td> <td>-7.55e-06</td>
</tr>
<tr>
  <th>Age</th>        <td>   -0.0037</td> <td>    0.002</td> <td>   -2.091</td> <td> 0.037</td> <td>   -0.007</td> <td>   -0.000</td>
</tr>
<tr>
  <th>Competitor</th> <td>    0.1684</td> <td>    0.026</td> <td>    6.534</td> <td> 0.000</td> <td>    0.118</td> <td>    0.219</td>
</tr>
<tr>
  <th>Store</th>      <td>   -0.1288</td> <td>    0.016</td> <td>   -7.948</td> <td> 0.000</td> <td>   -0.161</td> <td>   -0.097</td>
</tr>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Show AIC value matches STATS191 notes</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[121]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res2</span><span class="o">.</span><span class="n">aic</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[121]:</div>



<div class="output_text output_subarea output_execute_result">
<pre>571.0242714424356</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plot the Residuals against Fitted Values (seems OK)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[126]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">res2</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span>
    <span class="n">lumber</span><span class="p">[</span><span class="s1">&#39;Customers&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">res2</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span>
    <span class="s1">&#39;+&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also use the Object interface, but have to specify regularized fitting</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[145]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lumber</span><span class="p">[</span><span class="s1">&#39;Customers&#39;</span><span class="p">])</span>


<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="n">lumber</span><span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;Housing&#39;</span><span class="p">,</span> <span class="s1">&#39;Income&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Competitor&#39;</span><span class="p">,</span> <span class="s1">&#39;Store&#39;</span><span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[149]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res3</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit_regularized</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization terminated successfully.    (Exit mode 0)
            Current function value: 2.5410194156558066
            Iterations: 17
            Function evaluations: 39
            Gradient evaluations: 17
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[150]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res3</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[150]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<caption>Poisson Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>y</td>        <th>  No. Observations:  </th>  <td>   110</td>  
</tr>
<tr>
  <th>Model:</th>              <td>Poisson</td>     <th>  Df Residuals:      </th>  <td>   104</td>  
</tr>
<tr>
  <th>Method:</th>               <td>MLE</td>       <th>  Df Model:          </th>  <td>     5</td>  
</tr>
<tr>
  <th>Date:</th>          <td>Fri, 22 May 2020</td> <th>  Pseudo R-squ.:     </th>  <td>0.3547</td>  
</tr>
<tr>
  <th>Time:</th>              <td>21:11:48</td>     <th>  Log-Likelihood:    </th> <td> -279.51</td> 
</tr>
<tr>
  <th>converged:</th>           <td>True</td>       <th>  LL-Null:           </th> <td> -433.13</td> 
</tr>
<tr>
  <th> </th>                      <td> </td>        <th>  LLR p-value:       </th> <td>2.789e-64</td>
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    2.9424</td> <td>    0.207</td> <td>   14.198</td> <td> 0.000</td> <td>    2.536</td> <td>    3.349</td>
</tr>
<tr>
  <th>x1</th>    <td>    0.0006</td> <td>    0.000</td> <td>    4.262</td> <td> 0.000</td> <td>    0.000</td> <td>    0.001</td>
</tr>
<tr>
  <th>x2</th>    <td>-1.169e-05</td> <td> 2.11e-06</td> <td>   -5.534</td> <td> 0.000</td> <td>-1.58e-05</td> <td>-7.55e-06</td>
</tr>
<tr>
  <th>x3</th>    <td>   -0.0037</td> <td>    0.002</td> <td>   -2.091</td> <td> 0.037</td> <td>   -0.007</td> <td>   -0.000</td>
</tr>
<tr>
  <th>x4</th>    <td>    0.1684</td> <td>    0.026</td> <td>    6.534</td> <td> 0.000</td> <td>    0.118</td> <td>    0.219</td>
</tr>
<tr>
  <th>x5</th>    <td>   -0.1288</td> <td>    0.016</td> <td>   -7.948</td> <td> 0.000</td> <td>   -0.161</td> <td>   -0.097</td>
</tr>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[152]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res3</span><span class="o">.</span><span class="n">summary2</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[152]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<tr>
        <td>Model:</td>             <td>Poisson</td>     <td>Pseudo R-squared:</td>    <td>0.355</td>  
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>              <td>AIC:</td>         <td>571.0243</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-05-22 21:15</td>       <td>BIC:</td>         <td>587.2272</td> 
</tr>
<tr>
   <td>No. Observations:</td>         <td>110</td>        <td>Log-Likelihood:</td>    <td>-279.51</td> 
</tr>
<tr>
       <td>Df Model:</td>              <td>5</td>            <td>LL-Null:</td>        <td>-433.13</td> 
</tr>
<tr>
     <td>Df Residuals:</td>           <td>104</td>         <td>LLR p-value:</td>    <td>2.7887e-64</td>
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>           <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>17.0000</td>             <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>     <th>Coef.</th>  <th>Std.Err.</th>    <th>z</th>     <th>P>|z|</th> <th>[0.025</th>  <th>0.975]</th> 
</tr>
<tr>
  <th>const</th> <td>2.9424</td>   <td>0.2072</td>  <td>14.1977</td> <td>0.0000</td> <td>2.5362</td>  <td>3.3486</td> 
</tr>
<tr>
  <th>x1</th>    <td>0.0006</td>   <td>0.0001</td>  <td>4.2623</td>  <td>0.0000</td> <td>0.0003</td>  <td>0.0009</td> 
</tr>
<tr>
  <th>x2</th>    <td>-0.0000</td>  <td>0.0000</td>  <td>-5.5340</td> <td>0.0000</td> <td>-0.0000</td> <td>-0.0000</td>
</tr>
<tr>
  <th>x3</th>    <td>-0.0037</td>  <td>0.0018</td>  <td>-2.0913</td> <td>0.0365</td> <td>-0.0072</td> <td>-0.0002</td>
</tr>
<tr>
  <th>x4</th>    <td>0.1684</td>   <td>0.0258</td>  <td>6.5343</td>  <td>0.0000</td> <td>0.1179</td>  <td>0.2189</td> 
</tr>
<tr>
  <th>x5</th>    <td>-0.1288</td>  <td>0.0162</td>  <td>-7.9481</td> <td>0.0000</td> <td>-0.1605</td> <td>-0.0970</td>
</tr>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The bare-bones call to the Poisson object fails.  I don't really know why this interface fails</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[166]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res4</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>Warning: Maximum number of iterations has been exceeded.
         Current function value: 29876812607532474166702938553126939000832.000000
         Iterations: 35
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stderr output_text">
<pre>D:\Anaconda3\envs\ac5-py37\lib\site-packages\statsmodels\base\model.py:508: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  &#34;Check mle_retvals&#34;, ConvergenceWarning)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h1 id="Conclusions">Conclusions<a class="anchor-link" href="#Conclusions">&#182;</a></h1><p>This concludes my sweep through the STATS191 lecture notes, and I must say that I have learned a lot.  Obviously I would have to learn a lot more to be even close to being a statistician, and I suspect that analysing hundreds of datasets would be needed to gain a deep understanding of strengths and weaknesses of the various techniques</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Reproducibility">Reproducibility<a class="anchor-link" href="#Reproducibility">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[218]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">watermark</span> -h -iv
<span class="o">%</span><span class="k">watermark</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>seaborn     0.9.0
matplotlib  3.0.2
numpy       1.15.4
statsmodels 0.9.0
pandas      1.0.0
scipy       1.1.0
host name: DESKTOP-SODFUN6
2020-05-21T18:49:21+10:00

CPython 3.7.1
IPython 7.2.0

compiler   : MSC v.1915 64 bit (AMD64)
system     : Windows
release    : 10
machine    : AMD64
processor  : Intel64 Family 6 Model 94 Stepping 3, GenuineIntel
CPU cores  : 8
interpreter: 64bit
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[219]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">show_versions</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre>
INSTALLED VERSIONS
------------------
Python: 3.7.1.final.0

Statsmodels
===========

Installed: 0.9.0 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\statsmodels)

Required Dependencies
=====================

cython: 0.29.2 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\Cython)
numpy: 1.15.4 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\numpy)
scipy: 1.1.0 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\scipy)
pandas: 1.0.0 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\pandas)
    dateutil: 2.7.5 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\dateutil)
patsy: 0.5.1 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\patsy)

Optional Dependencies
=====================

matplotlib: 3.0.2 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\matplotlib)
    backend: module://ipykernel.pylab.backend_inline 
cvxopt: Not installed
joblib: 0.13.2 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\joblib)

Developer Tools
================

IPython: 7.2.0 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\IPython)
    jinja2: 2.10.1 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\jinja2)
sphinx: 1.8.2 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\sphinx)
    pygments: 2.3.1 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\pygments)
nose: 1.3.7 (D:\Anaconda3\envs\ac5-py37\lib\site-packages\nose)
pytest: 5.0.1 (D:\Anaconda3\envs\ac5-py37\lib\site-packages)
virtualenv: Not installed


</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

</div>
</div>
</div>

</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
 
	<a class="btn btn-mini xsmall" href="../stats19115.html">
          <i class="icon-comment"></i> Comment </a>
	<hr />
      </div>
      
    </div>
    

 
        



    <div class='row-fluid'>
      <div class='article-title span9'> 
        <a href="../stats19114.html"><h1>Stanford STATS191 in Python, Lecture 14 : Logistic Regression</h1></a>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<p>Fri 22 May 2020 </p>

<p style="text-align: left;">
Filed under <a href="../category/scipy.html">scipy</a>
</p>
<p style="text-align: left;">
 
    Tags <a href="../tag/statistics-scipy-statsmodels.html">statistics scipy statsmodels</a> </p>
<p>
</p>
      </div>
      <div class="summary span8">
	<p>Regression for binary dependent outcomes</p> 
	<a class="btn btn-mini xsmall" href="../stats19114.html">
          <i class="icon-plus-sign"></i> Read More </a>
	<hr />
      </div>
      
    </div>
      

 
        



    <div class='row-fluid'>
      <div class='article-title span9'> 
        <a href="../stats19112.html"><h1>Stanford STATS191 in Python, Lecture 12 : Selection</h1></a>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<p>Tue 05 May 2020 </p>

<p style="text-align: left;">
Filed under <a href="../category/scipy.html">scipy</a>
</p>
<p style="text-align: left;">
 
    Tags <a href="../tag/statistics-scipy-statsmodels.html">statistics scipy statsmodels</a> </p>
<p>
</p>
      </div>
      <div class="summary span8">
	<p>Selection of Parameters for Linear Models</p> 
	<a class="btn btn-mini xsmall" href="../stats19112.html">
          <i class="icon-plus-sign"></i> Read More </a>
	<hr />
      </div>
      
    </div>
      

 
        



    <div class='row-fluid'>
      <div class='article-title span9'> 
        <a href="../stats19111.html"><h1>Stanford STATS191 in Python, Lecture 10 : Bootstrapping regression</h1></a>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<p>Thu 23 April 2020 </p>

<p style="text-align: left;">
Filed under <a href="../category/scipy.html">scipy</a>
</p>
<p style="text-align: left;">
 
    Tags <a href="../tag/statistics-scipy-statsmodels.html">statistics scipy statsmodels</a> </p>
<p>
</p>
      </div>
      <div class="summary span8">
	<p>Using Bootstrap techniques to get Confidence Intervals for models with non-Gaussian Noise</p> 
	<a class="btn btn-mini xsmall" href="../stats19111.html">
          <i class="icon-plus-sign"></i> Read More </a>
	<hr />
      </div>
      
    </div>
      
<div class="pagination">
<ul>
    <li class="prev disabled"><a href="#">&larr; Previous</a></li>

    <li class="active"><a href="../category/scipy.html">1</a></li>
    <li class=""><a href="../category/scipy2.html">2</a></li>
    <li class=""><a href="../category/scipy3.html">3</a></li>
    <li class=""><a href="../category/scipy4.html">4</a></li>

    <li class="next"><a href="../category/scipy2.html">Next &rarr;</a></li>

</ul>
</div>

 
  
        </div>
        
        
    </div>     </div> </div>

<!--footer-->
<div class="container">
  <div class="well" style="background-color: #E9EFF6">
    <div id="blog-footer">
      <div class="row-fluid">
	<div class="social span2" align="center" id="socialist">
	  <ul class="nav nav-list">
	    <li class="nav-header">
	      Social
	    </li>
	    <li><a href="https://www.linkedin.com/in/donrcameron/"><i class="icon-Linkedin Page" style="color: #1f334b"></i>Linkedin Page</a></li>
	    <li><a href="https://www.flickr.com/photos/donrcameron/"><i class="icon-flickr Page" style="color: #1f334b"></i>flickr Page</a></li>
            <a href="mailto:donrcameron@gmail.com"><i class="icon-envelope" style="color: #1f334b" ></i> email</a>

	  </ul>
	</div>
<div class="span8" id="colophon">
  <h2 align="center">About</h2>
  <p align="justify"> 

This series of blog posts is provided as a resource by 

net-analysis.com - PO Box 857, Coolum Beach, QLD 4573, AUSTRALIA. ABN 19469649963.

Ring 0413 208 746, or visit the company website:

http://www.net-analysis.com.   It documents a learning process, and hence owes a debt of gratitude to all the people who have documented their own experiences on the web: the list is too large to enumerate.
 </p>
</div>
        <div class="links span2" align="center">
          <ul class="nav nav-list">
            <li class="nav-header"> 
              Links
            </li>
            
            <li><a href="http://getpelican.com/">Pelican</a></li>
            <li><a href="http://python.org/">Python.org</a></li>
          </ul>
        </div>
	<div class="site-nav span2" align="center">
          <ul class="nav nav-list" id="site-links">
            <li class="nav-header"> 
              Site
            </li>
            <li><a href=".."><i class="icon-home" style="color: #1f334b">
                </i>Home</a></li>
            <li><a href="../archives.html"><i class="icon-list" style="color: #1f334b">
                </i>Archives</a></li>
	    <li><a href="../tags.html"><i class="icon-tags" style="color: #1f334b">
                </i>Tags</a></li>
	    
	  </ul>

        </div>

      </div> <!--end of fluid row-->
    </div> <!--end of blog-footer-->
    <hr />
    <p align="center"><a href="..">net-analysis.com Data Analysis Blog</a>
      &copy; Don Cameron
    Powered by <a href="https://github.com/getpelican/pelican">Pelican</a> and
        <a href="https://twitter.github.com/bootstrap">Twitter Bootstrap</a>. 
        Icons by <a href="https://fortawesome.github.com/Font-Awesome">Font Awesome</a> and 
        <a href="https://gregoryloucas.github.com/Font-Awesome-More">Font Awesome More</a></p>

  </div> <!--end of well -->
</div> <!--end of container -->

<!--/footer-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>



</body>
</html>